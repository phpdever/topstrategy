webpackJsonp([8],{nIzK:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("WhmC"),n=s("Fd2+"),o=s("vMJZ"),i={name:"Message",components:{TheFooter:a.a},data:function(){return{head_box:{img1:"../../../static/home/sysmsg.png",img2:"../../../static/home/subscribe.png",img3:"../../../static/home/notify.png"},show:!1,show_name:!1,newpassword:"",password:"",nickname:"",file:"",avatar:"",user:{name:"",phone:"",userId:"",img:"",avatar:""},userinfo:{}}},mounted:function(){this.nickname=window.localStorage.getItem("USERNAME")||"",this.get_userinfo()},methods:{login_out:function(){var e=this;n.a.confirm({title:"提示",message:"你确定要退出登录吗？"}).then(function(){e.user_exit()}).catch(function(){})},get_userinfo:function(){var e=this;Object(o.e)({id:localStorage.getItem("USERID")||""}).then(function(t){t.state;var s=t.message;t.state?(e.userinfo=s,e.user.avatar="data:image/png;base64/"+s.img):n.b.fail("获取用户信息失败")}).catch(function(e){n.b.fail("获取用户信息失败")})},user_exit:function(){var e=this;Object(o.h)().then(function(){return e.$router.replace("/")}),localStorage.setItem("USERID",""),localStorage.setItem("USERNAME","")},edit_password:function(){this.show=!0},beforeClose:function(e,t){"confirm"===e?(this.submit_edit_passowrd(),setTimeout(t,1e3)):t()},edit_name:function(){this.show_name=!0},nicknameClose:function(e,t){var s=this;"confirm"===e?(""==this.nickname?n.b.fail("请填写昵称"):(this.user.userId=window.localStorage.getItem("USERID")||"",Object(o.n)({id:this.user.userId,name:this.nickname}).then(function(e){e.state?(s.get_userinfo(),n.b.success("昵称修改成功")):n.b.fail("昵称修改失败")}).catch(function(e){n.b.fail("昵称修改失败")})),setTimeout(t,1e3)):t()},submit_edit_passowrd:function(){return""==this.password||""==this.newpassword?(n.b.fail("请检查表单填写是否完整"),!1):this.password!=this.newpassword?(n.b.fail("密码不一致"),!1):(this.user.userId=window.localStorage.getItem("USERID")||"",void Object(o.o)({oldPassword:this.password,newPassword:this.newpassword}).then(function(e){e.state?n.b.success("密码修改成功"):n.b.fail("密码修改失败")}).catch(function(e){n.b.fail("密码修改失败")}))},onRead:function(e){this.$refs.goodsImg.src=e.content,this.user.userId=window.localStorage.getItem("USERID")||"",Object(o.n)({id:this.user.userId,img:e.content}).then(function(e){e.state?n.b.success("头像修改成功"):n.b.fail("头像修改失败")}).catch(function(e){n.b.fail("头像修改失败")})}}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("van-nav-bar",{attrs:{title:"个人资料","left-arrow":""},on:{"click-left":function(t){e.$router.back(-1)}}}),e._v(" "),s("div",{staticClass:"my-info"},[s("div",{staticClass:"Personal-2"},[s("span",[e._v("头像")]),e._v(" "),s("van-uploader",{staticStyle:{float:"right"},attrs:{"after-read":e.onRead,accept:"image/*",multiple:""}},[s("img",{ref:"goodsImg",staticClass:"head-img",attrs:{src:e.user.avatar}})])],1),e._v(" "),s("div",{staticClass:"Personal-3",on:{click:e.edit_name}},[s("span",[e._v("昵称")]),e._v(" "),s("span",{staticClass:"r-span"},[e._v(e._s(e.userinfo.name)+" >")])]),e._v(" "),s("div",{staticClass:"Personal-3",on:{click:e.edit_password}},[s("span",[e._v("修改登录密码")]),e._v(" "),s("span",{staticClass:"r-span"},[e._v(">")])]),e._v(" "),s("p",{staticClass:"zc-lc-left-p1",staticStyle:{"text-align":"center"},on:{click:e.login_out}},[s("input",{staticClass:"loginout_btn",attrs:{type:"button",value:"退出登录"}})])]),e._v(" "),s("van-dialog",{attrs:{"show-cancel-button":"","before-close":e.beforeClose},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[s("van-field",{attrs:{label:"旧密码",placeholder:"请输入旧密码"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),e._v(" "),s("van-field",{attrs:{type:"password",label:"新密码",placeholder:"请确认新密码"},model:{value:e.newpassword,callback:function(t){e.newpassword=t},expression:"newpassword"}})],1),e._v(" "),s("van-dialog",{attrs:{"show-cancel-button":"","before-close":e.nicknameClose},model:{value:e.show_name,callback:function(t){e.show_name=t},expression:"show_name"}},[s("van-field",{attrs:{label:"修改昵称",placeholder:"请输入要修改的昵称"},model:{value:e.nickname,callback:function(t){e.nickname=t},expression:"nickname"}})],1),e._v(" "),s("TheFooter")],1)},staticRenderFns:[]};var r=s("VU/8")(i,c,!1,function(e){s("wVLI")},null,null);t.default=r.exports},wVLI:function(e,t){}});
//# sourceMappingURL=8.dd5617b5827aa288f7eb.js.map